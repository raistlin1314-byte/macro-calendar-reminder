name: Daily Macro Calendar Reminder (Optimized Format)

on:
  schedule:
    # æ¯å¤©åŒ—äº¬æ—¶é—´ä¸Šåˆ9ç‚¹è¿è¡Œ (UTCæ—¶é—´å‡Œæ™¨1ç‚¹)
    - cron: '0 1 * * *'
  
  # å…è®¸æ‰‹åŠ¨è§¦å‘ï¼Œç”¨äºæµ‹è¯•
  workflow_dispatch:
    inputs:
      test_mode:
        description: 'æ˜¯å¦è¿è¡Œæµ‹è¯•æ¨¡å¼ (å‘é€æµ‹è¯•é€šçŸ¥)'
        required: false
        default: 'true'  # é»˜è®¤å¼€å¯æµ‹è¯•æ¨¡å¼ï¼Œæ–¹ä¾¿é¦–æ¬¡éªŒè¯

jobs:
  send-reminder:
    runs-on: ubuntu-latest
    # æ·»åŠ è¶…æ—¶è®¾ç½®ï¼Œé¿å…é•¿æ—¶é—´æŒ‚èµ·
    timeout-minutes: 5
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        # ç¡®ä¿è·å–å®Œæ•´å†å²ï¼Œä¾¿äºè°ƒè¯•
        fetch-depth: 1
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        echo "âœ… ä¾èµ–å®‰è£…å®Œæˆ"
        
    - name: Run reminder script
      env:
        PUSHPLUS_TOKEN: ${{ secrets.PUSHPLUS_TOKEN }}
        TEST_MODE: ${{ github.event.inputs.test_mode || 'true' }}  # é»˜è®¤å¼€å¯æµ‹è¯•
      run: |
        echo "ğŸš€ å¼€å§‹è¿è¡Œå®è§‚æ—¥å†æé†’å·¥å…·..."
        python reminder.py
        echo "âœ… è„šæœ¬æ‰§è¡Œå®Œæˆ"
      
    - name: Report job status
      if: always()
      run: |
        echo "ğŸ”” å®è§‚æ—¥å†æé†’ä»»åŠ¡æ‰§è¡Œå®Œæˆ"
        echo "ğŸ“‹ è¯·æ£€æŸ¥GitHub Actionsæ—¥å¿—å’Œå¾®ä¿¡é€šçŸ¥"
        echo ""
        echo "ğŸ’¡ æç¤ºï¼š"
        echo "   - å¦‚æœæ˜¯é¦–æ¬¡è¿è¡Œï¼Œå·²å‘é€æµ‹è¯•é€šçŸ¥"
        echo "   - æ­£å¸¸è¿è¡Œæ—¶ï¼Œä»…åœ¨æœ‰å³å°†å‘ç”Ÿçš„äº‹ä»¶æ—¶å‘é€é€šçŸ¥"
        echo "   - æ¯å¤©è‡ªåŠ¨æ‰§è¡Œæ—¶é—´ï¼šåŒ—äº¬æ—¶é—´ 09:00"
